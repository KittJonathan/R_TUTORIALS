---
title: "Palmer penguins"
format: 
  revealjs:
    chalkboard: true
    multiplex: true
editor: visual
execute:
  echo: false
  message: false
  warning: false
toc: true
toc-title: "Table des matières"
toc-location: body
toc-expand: false
bibliography: references.bib
language: 
  section-title-references: "Bibliographie"
---

# Introduction

## Données {.smaller}

Pour cette analyse, nous utilisons le dataset `penguins` du package [**palmerpenguins**](https://allisonhorst.github.io/palmerpenguins/) [@gorman2014].

```{r}
#| label: load-packages

library(tidyverse)
library(palmerpenguins)
library(gt)
```

Ce dataset contient `r nrow(penguins)` observations et `r ncol(penguins)` variables.

```{r}
#| label: glimpse-data

penguins |> 
  head() |> 
  gt()
```

# Analyse

## Dimensions du bec {.smaller}

Quelle est la relation entre la longueur et la hauteur du bec ?

La @fig-bill-dims ci-dessous représente cette relation à l'aide d'un nuage de points colorés selon l'espèce.

```{r}
#| label: fig-bill-dims
#| fig-cap: Relation entre la longueur et la hauteur du bec

penguins |>
  ggplot(aes(x = bill_length_mm,
             y = bill_depth_mm,
             col = species)) +
  geom_point() +
  labs(x = "Longueur bec (mm)",
       y = "Hauteur bec (mm)",
       col = "Espèce") +
  theme_bw() +
  theme(legend.position = "top",
        legend.title.position = "top",
        legend.title = element_text(hjust = 0.5))

```

## Nombre d'individus {.smaller}

La répartition des individus selon l'espèce et l'île est indiquée dans la @tbl-ind-count ci-dessous.

```{r}
#| label: tbl-ind-count
#| tbl-cap: Nombre d'individus par espèce et par île

penguins |> 
  count(species, island, name = "N") |> 
  complete(species, island, fill = list(N = 0)) |> 
  rename(Espèce = species, Île = island) |> 
  pivot_wider(id_cols = Espèce, names_from = Île, values_from = N) |> 
  gt() |> 
  tab_spanner(label = "Île",
              columns = -Espèce)

```
